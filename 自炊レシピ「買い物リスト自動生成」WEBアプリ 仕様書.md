自炊レシピ「買い物リスト自動生成」WEBアプリ 仕様書（Rails / MySQL / Docker / ローカル運用）
1. 目的

レシピ（1人前の材料）を手入力で登録し、**1週間の献立カレンダー（朝/昼/晩）**にレシピを割り当てる。

割り当てたレシピの材料を **「食材名 + 単位」**単位で合算し、最終的な買い物リストを自動生成する。

在庫管理はしない（単純に足し算）。

ログイン不要、基本ローカルで動作。

2. 技術要件（前提）

バックエンド：Ruby on Rails

フロント：HTML / CSS / JavaScript（フレームワークは任意。最低限の素のJSでもOK）

DB：MySQL

開発/実行：Docker利用（docker-compose想定）

利用形態：ローカル運用（本番公開は前提にしない）

3. 画面一覧

レシピ入力画面（レシピマスタ）

買い物リスト画面（週間カレンダー + 集計結果）

4. データ仕様（概念レベル）
4.1 レシピ（Recipe）

レシピ名（必須）

写真（任意）

材料リスト（複数）

4.2 材料（Ingredient）

食材名（必須）

数量（必須・小数OK）

単位（必須）

調味料フラグ（必須：true/false）

true の材料は 買い物リスト集計から除外

※ “調味料”という概念自体は必要（除外判定に使うため）

4.3 献立カレンダー（Plan / Week）

表示は「今日〜6日後」の7日間

各日には以下の枠がある

朝（Morning）

昼（Lunch）

晩（Dinner）

各枠には 複数レシピを入れられる

各レシピごとに **人数（倍率）**を指定できる（例：2人分、3人分）

倍率はレシピの材料（1人前）に掛け算して集計

5. レシピ入力画面（マスタ）仕様
5.1 できること

レシピの新規作成

レシピの編集

レシピの一覧表示（検索は任意）

レシピの削除（任意。ただし削除したレシピが献立に入っていた場合の扱いは 8.4参照）

5.2 入力項目
レシピ基本情報

レシピ名：必須、最大長は実装者判断（例：100文字）

写真：任意

画像アップロード（ローカル運用前提でOK。ActiveStorage等は任意）

なくても動くこと

材料入力（複数行）

材料は 1レシピにつき複数行入力できる。

食材名（必須）

合算判定は「同じ文字列なら同一」とする

例：「玉ねぎ」と「たまねぎ」は別物（正規化しない）

前後空白はトリム（推奨）

数量（必須）

小数OK（例：0.5）

0より大きいこと（0は不可推奨）

単位（必須）

よく使う単位はプルダウン提供（詳細は 5.3）

プルダウン以外の単位を許可するかは実装方針（推奨：自由入力も可能にして拡張性確保）

調味料チェック（必須：チェックボックス）

ONなら買い物リストに出さない

5.3 単位プルダウン要件

最低限以下を候補に含める（追加OK）

g / ml / 個

（任意追加候補例）枚、本、束、袋、缶、さじ、適量

単位は 集計キーの一部になる（「食材名 + 単位」で合算）

5.4 バリデーション（最低限）

レシピ名：必須

材料行：

食材名：必須

数量：必須、数値、小数可、0より大きい

単位：必須

調味料フラグ：必須（UI上はチェック有無でOK）

材料が1行もないレシピを許容するかは任意（推奨：最低1行必須）

6. 買い物リスト画面 仕様
6.1 画面構成

上部：7日間カレンダー（今日〜6日後）

表示順：今日を1日目として横並び or 縦並び（どちらでも良い）

例：今日が木曜なら「木 金 土 日 月 火 水」

各日ごとに「朝/昼/晩」の3枠がある

下部または右側：買い物リスト（集計結果）表示領域

「この週の献立をリセット」などは任意

6.2 献立枠の挙動（朝/昼/晩）

各枠をクリックすると レシピ選択UIが開く（モーダル/別エリア/別画面など実装任意）

その枠には 複数レシピ追加できる

追加済みレシピは枠内に一覧表示

レシピ名

人数（倍率）

削除ボタン（その枠から外す）

人数変更UI（プルダウン or 数値入力）

6.3 レシピ選択UI要件

レシピ一覧から選択して枠に追加できる

追加時に「人数（倍率）」を指定できる

初期値：1

小数倍率を許可するかは任意（推奨：整数のみ 1〜10 など）

同じ枠に同じレシピを複数回入れる扱い

推奨仕様：入れられる（「別レシピ扱い」ではなく、結果は合算される）

ただしUI上は重複が分かりにくいので、実装側で「同枠同レシピなら1行にまとめて人数を合算」しても良い（どちらでもOK。集計結果は同じになる）

6.4 買い物リストの集計ルール（最重要）
集計対象

カレンダーに入っている全枠（7日×3枠）に入った全レシピの材料を対象

ただし、材料の 調味料フラグ = true は除外

掛け算（人数対応）

レシピ材料は「1人前」で登録されている

カレンダー枠に入れた際の人数（倍率）を材料数量に掛け算

例：材料「鶏むね肉 200 g（調味料=false）」

3人分なら 600 g として集計

合算キー

合算は **「食材名 + 単位」**が完全一致するもの同士で行う

単位が違う場合は別行（例：牛乳 200 ml と 牛乳 1 本 は別）

食材名は 同じ文字列なら同一（表記ゆれ吸収なし）

トリム等の軽い正規化は実装側で行ってよい（推奨：前後空白削除）

数量の扱い（小数）

小数で合算する

表示の丸め：

推奨：DB/内部は小数保持、表示は最大2桁〜3桁程度（実装側判断）

端数処理ルールを統一（例：表示は小数第2位まで、四捨五入）

6.5 買い物リスト表示仕様

一覧の各行に表示する項目：

食材名

合算数量

単位

並び順：

推奨：食材名の昇順 → 単位昇順

フィルタ：

推奨（任意）：調味料除外ON/OFFの切替（デフォルトは除外ON）

ただし現行仕様では「調味料は買い物リストに含めない」が確定なので、切替はなくてもOK

7. 週の基準・日付仕様

買い物リスト画面は常に「今日〜6日後」の7日間を表示する

“今日”はユーザーのローカル日付（ブラウザ/サーバ時刻のどちら基準でもよいが、ローカル運用なのでズレが出ない実装を推奨）

週の開始曜日固定（例：月曜始まり）はしない

今日の曜日が1日目になる

8. 状態管理（保存範囲）

※ユーザーは「基本ローカル」とのみ指定。ここは実装選択肢を明確化する。

8.1 推奨方針（シンプル）

献立カレンダー（7日分の割当）はDBに保存する

ページ更新・再起動しても献立が残る

ただし “週” は「今日〜6日後」なので、日付が進むと表示範囲がずれる

保存する場合は「日付 + 食事区分 + レシピ + 人数」を持つ

8.2 さらにシンプルな代替（任意）

献立はDBに保存せず、フロントのLocalStorageに保持でも可

ただしRailsアプリとして作るならDB保存の方が自然

8.3 週をまたいだデータの扱い

仕様上は「今日〜6日後」だけ表示できればOK

過去日の献立履歴・未来週の計画などは不要

8.4 レシピ削除時の扱い（推奨）

レシピが献立に紐づいている場合

推奨：削除は不可（もしくは警告して献立から自動削除）

最低限：不整合で画面が壊れないこと

9. 非機能要件（最低限）

ローカルでDocker起動してすぐ使える

初期セットアップが簡単（DB作成/マイグレーション/seedなど）

画面はスマホ対応必須ではないが、崩れない程度に配慮（任意）

ログイン不要（認証機能を作らない）

10. 仕様の確定事項まとめ（ユーザー要望の最終確定）

材料入力形式：食材名 / 数量 / 単位

集計：食材名 + 単位で合算（単位が違えば別行）

食材名の同一判定：同じ文字列なら同一

数量：小数OK

レシピ登録は 1人前

献立に入れるときに 人数（倍率）を指定し、数量を掛け算

1枠（例：月曜夜）に 複数レシピ登録可能

調味料は買い物リストに 含めない

実装方針：材料登録時に **「調味料チェック」**を持たせる

買い物リスト画面のカレンダー：今日〜6日後の7日間を表示（今日が1日目）

ログイン不要

フロント：HTML/CSS/JS

DB：MySQL